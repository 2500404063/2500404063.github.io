# 链路层
计算机网络层（由顶至底）：
1. 应用层
2. 运输层
3. 网络层
4. 链路层
5. 物理层

链路层主要由两种通信方式。
1. 点对点的通信协议
2. 广播的通信协议

这里的结点指的是运行链路层协议的任何设备，而连接这些结点的通信信道称为链路。
**链路层是具有实实在在的物理线路的层。**
![h1toh2](./pages_appdev/network/res/1.png)

## 链路层的构成
链路层是软件和硬件的结合体，链路层的主体部分是在网络适配器，又叫网络接口卡上实现的，而位于网络适配器的核心是链路层控制器，该控制器是实现了众多链路层服务的专用芯片，因此链路层的许多功能是硬件实现的。

## 链路层的作用
1. 封装成帧：就是把数据形成一个一个的包。这个包叫做`IP数据报`。
2. 透明传输：不管所传数据是什么样的比特组合，都应当能够在链路上传送。
3. 差错检测：就是判断一个包的正确性。

### 封装成帧
封装成帧的办法就是将数据包加上头尾标识。
例如：SOH DATA EOT
SOH(Start of Header)
EOF(End of Transmission)
这样做会带来很多好处，如果一个包出现损坏，我们可以只丢弃这一个包，而保留其他正确的数据包。
### 透明传输
当我们把某一些值作为控制码的时候，例如SOH的值是01H，则如果DATA当中包含01H就会出错。
解决这种问题的方法就是使用转义符（ESC）。
例如转义符是10H
01表示SOH，而10 01表示01这个数据。
对于数据为10H来说，只需要两次转义即可，10 10表示10这个数据。
### 差错检测
差错检测有多种方法：
1. 奇偶校验
2. CRC循环冗余校验

网络当中使用的是CRC校验，具体算法请看其他资料。

## MAC地址
MAC(Media Access Control Address)地址是**硬件标识**。
每一个网卡都具有唯一的硬件ID，即MAC地址。
硬件之间的通信也就是凭借MAC来寻找的。
MAC地址是6个字节，FF:FF:FF:FF:FF:FF

## 一些硬件
1. 适配器
2. 集线器
3. 网桥
4. 以太网交换机

### 适配器
网络适配器的俗称叫“网卡”，负责计算机和其他网络的连接。
网络适配器实现了一些网络的协议，具有单独的芯片来处理网络事务，而不使用CPU的处理资源。
计算机只需要把需要发送的数据丢给网络适配器，网络适配器可以封装成帧，然后发出。

### 集线器
集线器实现了共享总线的作用，把多台计算机连接到同一个数据传输总线上。
同一时间，只允许一台计算机占用总线。

### 网桥
网桥起到转发数据，中继信号的作用（因为信号在传输过程中会衰减），从而网桥使得多条网络连在一起。
可以起到扩大局域网的目的。

### 以太网交换机
交换机的本质是多接口的网桥。其区别是，交换机具有并行性，**以太网交换机的结构是每个端口都直接与主机相连**，并且一般都工作在全双工方式。
交换机能同时连通许多对端口，使每一对相互通信的主机都能像独占通信媒体那样，进行无冲突地传输数据。

交换机具有自主学习功能。
例如A给B发消息，B又给A发消息，然后就会产生如下表
交换表：
MAC       接口
 A         1
 B         3
通过MAC地址来确定接口号，然后直接发数据到对应接口。
从而实现A和B的互通，而不需要手动配置。

## 虚拟局域网(VLAN)
通过**以太网交换机**，可以轻松实现虚拟局域网。
![vlan](./pages_appdev/network/res/vlan.png)
从图中可见，3台交换机都连接到了最下面的交换机。
上面3台交换机，形成了三个局域网：
1. LAN1：(A1,A2,B1,C1)
2. LAN2：(A3,B2,C2)
3. LAN3：(A4,B3,C3)

因为这三台交换机都连接着最下面的交换机，所以理论上LAN1和LAN2和LAN3的主机也可以相互通信。
所以，也可以划分成如下局域网，即虚拟局域网。
1. VLAN1：(A1,A2,A3,A4)
2. VLAN2：(B1,B2,B3)
3. VLAN3：(C1,C2,C3)

虚拟局域网解决了**广播风暴问题**。
因为广播传输方式，会广播到很多台计算机，通过划分虚拟局域网，就可以广播到一部分的机器上。
VLAN实现了**自定义的用户组(局域网)管理**。