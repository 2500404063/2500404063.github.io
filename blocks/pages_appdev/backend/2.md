# HTTP后端产品级开发规范

参与了一个论坛开发项目，负责后端。得到了一些实战后的启示和产品的规范。
无论是什么技术，其实都还是分（实验室级和产品级）。
实验室级指：情况都很理想，有限访问，数据量小，无冲突，无恶意来访等。
产品级指：极限的访问，数据量很多，有冲突，有恶意来访等。

## 数据库设计

后端，第一件事肯定是去设计数据库。数据库设计我的想法是，
1. 分层
2. 分析数据从数据表中的查询方式
3. 当记录量很大的时候分表是否方便
一般步骤：
1. 根据业务要求找到每个需要数据的地方，分析这些数据从数据表中查询的方式，
2. 根据模块划分模块的层次关系。例如：
**各个层级需要建立好ID关系，就是父可以找到子，子也知道父是谁。**

```c
话题{
    话题ID
    话题标题
    话题ICON
    提问{
        提问ID
        话题ID
        提问标题
        提问内容
        回答{
            回答ID
            提问ID
            回答内容
        }
    }
}
```

## 后端项目结构

model: 负责将数据表转换成结构体的，也可以根据结构体来动态创建数据库，可以省去用sql创建数据表了。推荐创建数据库的时候也不必去使用sql，直接写这里。
migration：就几句代码，配置哪些数据表（model）去动态创建数据库。
model_json：这个没有特定名字，作用就是将model中抽出一部分，来表示哪些字段是需要写入响应头的。不要也可以。
service：用来进行数据库底层操作的CRUD
routes: 路由表
controller：负责处理路由，里面的代码很简单，就是调用service，和请求头的验证，返回响应头。
middleware: 这个的作用就像是防火墙，用来配置一些准使用API的规则。
response：定义响应头规范。一般规范是 {code:0, data:{}, msg:""}
其他的，根据项目需要来加。一般的规范也就上面这些。
但是不同的公司要求可能不一样，但是基本都差不多。

## Restful API

Restful API规范，大概就是下面这样：
1. 使用GET POST PUT DELETE来表示动词
2. 路由全部都是名词
形成：及物动词+名词的形式

## Token令牌

使用Token来进行身份验证，可以使用SHA256加密。
Token验证使用请求头的Authorization字段。
有不同的验证方式，常用的一种是Bearer Token。

## 后端总结

后端其实还是容易的，代码逻辑都相似，没有特别复杂的地方。
最重要的还是得掌握一些数据库和缓存数据库（redis等），如果使用了不同的语言，写法会变化，但是最根本的知识不会变化。
