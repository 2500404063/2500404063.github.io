# 计算机是状态机
“计算机是状态机” 怎么理解呢？

## 从堆栈的角度理解
堆(Heap)和栈(Stack)，都是RAM当中的一部分，作用就是储存。
所以，状态机就是可以储存状态的机器。

## C语言的语义
C语言写出来的程序，为什么可以跑在操作系统上？
我们来进行剖析一下。

### C语言的编译过程
1. 编译预处理指令：预处理指令是给编译器看的一些指令，协助编译的
2. 编译成汇编代码（机器码的助记符）：把更加适合人类阅读的代码转换成汇编
3. 编译成目标代码（机器码）：就是CPU指令
4. 链接成可执行文件：形成Windows下的exe文件，Linux下的elf文件。

### 程序运行过程
可执行文件里面包含了多个目标文件（目标代码），又包含了一些描述这个可执行文件的信息，
例如，文件类型信息，导入表，导出表，入口点，各种符号，debug相关信息等。

当我们双击一个程序，或者Linux下执行./xxx的时候，
**操作系统会去寻找对应可以打开这个文件的程序。**
注意这句话，Windows系统通过exe后缀名来判断是否是可执行文件，但是Linux下没有后缀名，所以Linux有一个可执行的权限，并且在Linux系统下，elf文件该用什么程序打开，也记录在elf文件里面了。

然后接下来，就是操作系统的程序加载器（Loader），读取可执行文件的内容，对文件进行解析，然后装载到内存。

然而实际上，这个过程是相当复杂的，我们以后再讲。

### 裸机程序
目标代码是可以直接交给CPU执行的，就是CPU操作指令。
裸机程序因为没有操作系统，所以是直接加载CPU指令。

### 汇编语言的语义
可以说汇编语言就是机器码，只不过是机器码的一种助记符。

### 编译器的作用
1. 分析C语言代码：对C语言代码进行优化，产生正确的汇编代码。
2. 把汇编代码转换成机器码
3. 把多个目标文件进行链接，形成对应平台下的应用程序文件。

## 操作系统提供了什么
操作系统负责处理与硬件的交互，比如和其他器件的通信，驱动各种外设。
操作系统为应用程序提供了syscall API，而操作系统上的应用程序通过这些来与硬件交互。

所以，应用程序无法直接和硬件打交道，必须通过syscall.
汇编通过int 指令来进入中断，C语言通过syscall头文件。