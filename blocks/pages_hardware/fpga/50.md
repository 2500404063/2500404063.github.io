# 原语和IP核

## 原语
原语（Primitive），的意思是**原始的语言**。
我们知道一个FPGA拥有很多的**硬件资源**（如LUT，D触发器，RAM等）我们通过描述这些个资源的连线和状态，来实现功能。
原语的意思就是，我们**直接指明LUT和D触发器等硬件资源**的状态和连线来实现XXX功能。
使用HDL的意思是，我们**描述功能逻辑**，EDA软件会帮我们转换成原语，再实现功能。
这就类似于**汇编语言**和**C语言**的区别。
**总结：**
原语是一种更加底层的**描述电路**的语言，直接使用FPGA现有资源的名字来进行组合利用。
HDL是一种更加抽象的**描述电路功能**的语言，并不直接操作具体的资源。

## IP Core
IP核（Intellectual Property Core）知识产权核（知识产权模块），可以理解成软件开发里面的库一样，也是受到知识财产保护的。

IP核不是一个具体的概念，而是一个抽象的概念，泛指这类，被一些人设计经过测试，具有一定价值，受到知识产权保护的的任何知识性东西。

调用IP核能避免重复劳动，大大减轻工程师的负担，因此使用IP核是一个发展趋势，IP核的重用大大缩短了产品上市时间。

IP核有三种不同的存在形式：HDL语言形式，网表形式、版图形式。
分别对应我们常说的三类IP内核：软核、固核和硬核。这种分类主要依据产品交付的方式，而这三种IP内核实现方法也各具特色。

### 软核(Soft IP Core)
软核在EDA设计领域指的是综合之前的寄存器传输级(RTL) 模型；具体在FPGA设计中指的是对电路的硬件语言描述，包括逻辑描述、网表和帮助文档等。软核只经过功能仿真，需要经过综合以及布局布线才能使用。其优点是灵活性高、可移植性强，允许用户自配置；缺点是对模块的预测性较低，在后续设计中存在发生错误的可能性，有一定的设计风险。软核是IP 核应用最广泛的形式。

### 固核(Firm IP Core)
固核在EDA设计领域指的是带有平面规划信息的网表；具体在FPGA设计中可以看做带有布局规划的软核，通常以RTL 代码和对应具体工艺网表的混合形式提供。将RTL描述结合具体标准单元库进行综合优化设计，形成门级网表，再通过布局布线工具即可使用。和软核相比，固核的设计灵活性稍差，但在可靠性上有较大提高。目前，固核也是IP核的主流形式之一。

### 硬核(Hard IP Core)
固核则是软核和硬核的折衷。大多数应用于FPGA的IP内核均为软核，软核有助于用户调节参数并增强可复用性。

硬核在EDA 设计领域指经过验证的设计版图；具体在FPGA 设计中指布局和工艺固定、经过前端和后端验证的设计，设计人员不能对其修改。不能修改的原因有两个：首先是系统设计对各个模块的时序要求很严格，不允许打乱已有的物理版图；其次是保护知识产权的要求，不允许设计人员对其有任何改动。IP 硬核的不许修改特点使其复用有一定的困难，因此只能用于某些特定应用，使用范围较窄。

### IP Core生成器
IP Core生成器(Core Generator) 是Xilinx FPGA设计中的一个重要设计工具，提供了大量成熟的、高效的IP Core为用户所用，涵盖了汽车工业、基本单元、通信和网络、数字信号处理、FPGA特点和设计、数学函数、记忆和存储单元、标准总线接口等8 大类，从简单的基本设计模块到复杂的处理器一应俱全。配合赛灵思网站的IP中心使用，能够大幅度减轻设计人员的工作量，提高设计可靠性。

## 一个调用IP核的例子
```verilog
module LED0_Flashing(
    output reg[5:0] led
);

reg[24:0] count;
wire oscclk;

OSC MyOSC(
    .OSCOUT(oscclk)
);
defparam MyOSC.FREQ_DIV=10;
defparam MyOSC.DEVICE="GW1NR-9C";

always @(posedge oscclk) begin
    if(count < 25'd2500_0000) begin
        count <= count + 1;
    end else begin
        count <= 25'd0;
        led <= ~led;
    end
end

endmodule
```
在这个例子中，我们通过原语的方式，使用OSC硬件资源，来产生一个时钟，利用这个时钟我们实现了一个闪烁灯的功能。

对于IP Core，其实也是通过调用原语来实现的，而IP核生成器，可以帮助我们生产上述原语部分的代码。